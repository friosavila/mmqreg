<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Fernando Rios-Avila">
<meta name="author" content="Leonardo Siles">
<meta name="author" content="Gustavo Canavire-Bacarreza">
<meta name="dcterms.date" content="2023-10-23">
<meta name="keywords" content="Fixed effects, Linear heteroskedasticity, Location-scale model, Quantile regression">

<title>Quantile Regressions via Method of Moments with multiple fixed effects</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="article_files/libs/clipboard/clipboard.min.js"></script>
<script src="article_files/libs/quarto-html/quarto.js"></script>
<script src="article_files/libs/quarto-html/popper.min.js"></script>
<script src="article_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="article_files/libs/quarto-html/anchor.min.js"></script>
<link href="article_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="article_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="article_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="article_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="article_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="..\article.pdf"><i class="bi bi-file-pdf"></i>PDF (elsevier)</a></li></ul></div></div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Quantile Regressions via Method of Moments with multiple fixed effects</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliations</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Fernando Rios-Avila </p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Levy Economics Institute of Bard College
          </p>
      </div>
      <div class="quarto-title-meta-contents">
    <p class="author">Leonardo Siles </p>
  </div>
      <div class="quarto-title-meta-contents">
    <p class="author">Gustavo Canavire-Bacarreza </p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            World Bank
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 23, 2023</p>
    </div>
  </div>
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="abstract-title">Abstract</div>
    <p>This paper proposes a new method to estimate quantile regressions with multiple fixed effects. The method expands on the strategy proposed by <span class="citation" data-cites="mss2019">Machado and Santos Silva (<a href="#ref-mss2019" role="doc-biblioref">2019</a>)</span>, allowing for multiple fixed effects, and providing various alternatives for the estimation of Standard errors. We provide Monte Carlo simulations to show the finite sample properties of the proposed method in the presence of two sets of fixed effects. Finally, we apply the proposed method to estimate <strong>something interesting</strong></p>
  </div>
</div>

</header>

<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Quantile regression (QR), introduced by <span class="citation" data-cites="koenkerbasset1978">Koenker and Bassett (<a href="#ref-koenkerbasset1978" role="doc-biblioref">1978</a>)</span>, is an estimation strategy used for modeling the relationships between explanatory variables X and the conditional quantiles of the dependent variable <span class="math inline">\(q_\tau (y|x)\)</span>. Using QR one can obtain richer characterizations of the relationships between dependent and independent variables, by accounting for otherwise unobserved heterogeneity.</p>
<p>A relatively recent development in the literature has focused on extending quantile regressions analysis to include individual fixed effects in the framework of panel data. However, as described in <span class="citation" data-cites="neymanscott1948">Neyman and Scott (<a href="#ref-neymanscott1948" role="doc-biblioref">1948</a>)</span>, and <span class="citation" data-cites="lancaster2000">Lancaster (<a href="#ref-lancaster2000" role="doc-biblioref">2000</a>)</span>, when individual fixed effects are included in quantile regression analysis it generates an incident parameter problem. While many strategies have been proposed for estimating this type of model (see Galvão and Kato, 2018 for a brief review), neither has become standard because of their restrictive assumptions in regards to the individual effects, the computational complexity, and implementation.</p>
<p>More recently, <span class="citation" data-cites="mss2019">Machado and Santos Silva (<a href="#ref-mss2019" role="doc-biblioref">2019</a>)</span> (MSS hereafter) proposed a methodology based on a conditional location-scale model similar to the one described in <span class="citation" data-cites="he1997">He (<a href="#ref-he1997" role="doc-biblioref">1997</a>)</span>, for the estimation of quantile regressions models for panel data via a method of moments. This method allows individual fixed effects allowing to have heterogeneous effects on the entire conditional distribution of the outcome, rather constraining their effect to be a location shift only as in <span class="citation" data-cites="canay2011">Canay (<a href="#ref-canay2011" role="doc-biblioref">2011</a>)</span>, <span class="citation" data-cites="koenker2004">Koenker (<a href="#ref-koenker2004" role="doc-biblioref">2004</a>)</span>, and <span class="citation" data-cites="lancaster2000">Lancaster (<a href="#ref-lancaster2000" role="doc-biblioref">2000</a>)</span>.</p>
<p>In principle, under the assumption that data generating process behind the data is based on a multiplicative heteroskedastic process that is linear in parameters (<span class="citation" data-cites="cameron2005">Cameron and Trivedi (<a href="#ref-cameron2005" role="doc-biblioref">2005</a>)</span>; <span class="citation" data-cites="mss2019">Machado and Santos Silva (<a href="#ref-mss2019" role="doc-biblioref">2019</a>)</span>; <span class="citation" data-cites="he1997">He (<a href="#ref-he1997" role="doc-biblioref">1997</a>)</span>), the effect of a variable <span class="math inline">\(X\)</span> on the <span class="math inline">\(q_th\)</span> quantile can be derived as the combination of a location effect, and scale effect moderated by the quantile of an underlying i.i.d. error. For statistical inference, MSS derives the asymptotic distribution of the estimator, suggesting the use of bootstrap standard errors, as well.</p>
<p>While this methodology is not meant to substitute the use of standard quantile regression analysis, given the assumptions required for the identification of the model, it provides a simple and fast alternative for the estimation of quantile regression models with individual fixed effects.</p>
<p>In this framework, our paper expands on <span class="citation" data-cites="mss2019">Machado and Santos Silva (<a href="#ref-mss2019" role="doc-biblioref">2019</a>)</span>, following some of the suggestions by the authors regarding further research. First, making use of the properties of GMM estimators, we derive various alternatives for the estimation of standard errors based on the empirical Influence functions of the estimators. Second, we reconsider the application of Frisch–Waugh–Lovell (FWL) theorem (<span class="citation" data-cites="frishwaugh1933">Frisch and Waugh (<a href="#ref-frishwaugh1933" role="doc-biblioref">1933</a>)</span> and <span class="citation" data-cites="lovell1963">Lovell (<a href="#ref-lovell1963" role="doc-biblioref">1963</a>)</span>) to extend the MSS estimator to allow for the inclusion of multiple fixed effects, for example, individual and year fixed effects.</p>
<p>The rest of the paper is restructured as follows. Section 2 presents the basic setup of the location-Scale model described in <span class="citation" data-cites="he1997">He (<a href="#ref-he1997" role="doc-biblioref">1997</a>)</span>, tying the relationship between the standard quantile regression model, and the location and scale model. It also revisits MSS methodology, proposing alternative estimators for the standard errors based on the properties of GMM estimators and the empirical influence functions. It also shows that FWL theorem can be used to control for multiple fixed effects. Section 3 presents the results of a small simulation study and Section 4 illustrates the application of the proposed methods with two empirical examples. Seccion 5 concludes.</p>
</section>
<section id="methodology" class="level1">
<h1>Methodology</h1>
<section id="quantile-regression-location-scale-model" class="level2">
<h2 class="anchored" data-anchor-id="quantile-regression-location-scale-model">Quantile Regression: Location-Scale model</h2>
<p>Quantile regressions are used to identify relationships between the explanatory variables <span class="math inline">\(x\)</span> and the conditional quantiles of the dependent variable <span class="math inline">\(Q(y|\tau,X)\)</span>. This relationship is commonly assumed to follow a linear functional form:</p>
<p><span id="eq-eq1"><span class="math display">\[Q(Y|X,\tau) =X\beta(\tau)
\tag{1}\]</span></span></p>
<p>This allows for nonlinearities in the effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> across all values of <span class="math inline">\(\tau\)</span>. This formulation can also be related to a random coefficient model, where all coefficients are assumed to be some nonlinear function of <span class="math inline">\(\tau\)</span>, where <span class="math inline">\(\tau\)</span> follows a random uniform distribution.</p>
<p>An alternative formulation of quantile regressions is the location-scale model. This approach assumes that the conditional quantile of <span class="math inline">\(Y\)</span> given <span class="math inline">\(X\)</span> and <span class="math inline">\(\tau\)</span> can be expressed as a combination of two models: the location model, which describes the central tendency of the conditional distribution, and the scale model, which describes deviations from the central tendency:</p>
<p><span id="eq-eq2"><span class="math display">\[Q(Y|X,\tau) =X\beta+X\gamma(\tau)
\tag{2}\]</span></span></p>
<p>Here, the location parameters <span class="math inline">\(\beta\)</span> are typically identified using a linear regression model (as in <span class="citation" data-cites="mss2019">Machado and Santos Silva (<a href="#ref-mss2019" role="doc-biblioref">2019</a>)</span>), or a median regression (as in <span class="citation" data-cites="melly2005">Melly (<a href="#ref-melly2005" role="doc-biblioref">2005</a>)</span>), and the scale parameters <span class="math inline">\(\gamma(\tau)\)</span> can be estimated using standard approaches.</p>
<p>Both the standard quantile regression (<a href="#eq-eq1">Equation&nbsp;1</a>) and the location-scale specification (<a href="#eq-eq2">Equation&nbsp;2</a>) can be estimated as the solution to a weighted minimization problem:</p>
<p><span id="eq-eq3"><span class="math display">\[\hat{\beta}(\tau) = \underset{\beta}{\operatorname{argmin}}
\left( \sum_{i\in y_i\geq x_i'\beta} \tau (y_i - x_i'\beta) - \sum_{i\in y_i&lt;x_i'\beta} (1-\tau)(y_i - x_i'\beta) \right)
\tag{3}\]</span></span></p>
<p>One characteristic of this estimator is that the <span class="math inline">\(\beta(\tau)\)</span> coefficients are identified locally, and thus the estimated quantile coefficients will exhibit considerable variation when analyzed across <span class="math inline">\(\tau\)</span>. It is also implicit that if one requires an analysis of the entire distribution, it would be necessary to estimate the model for each quantile.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>One insightful extension to the location-scale parameterizations suggested by <span class="citation" data-cites="he1997">He (<a href="#ref-he1997" role="doc-biblioref">1997</a>)</span>, <span class="citation" data-cites="cameron2005">Cameron and Trivedi (<a href="#ref-cameron2005" role="doc-biblioref">2005</a>)</span>, and <span class="citation" data-cites="mss2019">Machado and Santos Silva (<a href="#ref-mss2019" role="doc-biblioref">2019</a>)</span> is to assume that the data-generating process (DGP) can be written as a linear model with a multiplicative heteroskedastic process that is linear in parameters.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p><span id="eq-eq4"><span class="math display">\[y_i=x_i'\beta+\varepsilon_i \times x_i'\gamma(\tau)
\tag{4}\]</span></span></p>
<p>Under the assumption that <span class="math inline">\(\varepsilon\)</span> is an independent and identically distributed (iid) unobserved random variable that is independent of <span class="math inline">\(X\)</span>, the conditional quantile of <span class="math inline">\(Y\)</span> given <span class="math inline">\(X\)</span> and <span class="math inline">\(\tau\)</span> can be written as:</p>
<p><span id="eq-eq5"><span class="math display">\[Q(Y|X,\tau) =X\beta+X\gamma \times Q(\varepsilon|\tau)
\tag{5}\]</span></span></p>
<p>In this setup, the traditional quantile coefficients are identified as the location model coefficients, plus the scale model coefficients moderated by the <span class="math inline">\(\tau_th\)</span> unconditional quantile of the standardized error <span class="math inline">\(\varepsilon\)</span>.</p>
<p><span id="eq-eq6"><span class="math display">\[\beta(\tau) = \beta + \gamma \times Q(\varepsilon|\tau)
\tag{6}\]</span></span></p>
<p>While this specification imposes a strong assumption on the DGP, it has two advantages over the standard quantile regression model. First, because the location and scale model can be identified globally, with only a single parmater (<span class="math inline">\(Q(\varepsilon|\tau)\)</span>) requiring local estimation, this estimation approach would be more efficient than the standard quantile regression model. Second, under the assumption that <span class="math inline">\(X\gamma\)</span> is strictly possitive, the model would produce quantile coefficients that do not cross.</p>
</section>
<section id="estimation" class="level2">
<h2 class="anchored" data-anchor-id="estimation">Estimation</h2>
<p>Following MSS, the quantile regression model defined by <a href="#eq-eq5">Equation&nbsp;5</a> can be estimated using a method of moments approach. And while its possible to identify all coefficients (<span class="math inline">\(\beta,\gamma, Q(\varepsilon|\tau)\)</span>) simultaneously, we describe and use the implementation approach advocated by MSS which identifies each set of coefficients separately.</p>
<ol type="1">
<li><p>The location model can be estimated using a standard linear regression model, where the dependent variable is the outcome <span class="math inline">\(Y\)</span>, and the independent variables are the explanatory variables <span class="math inline">\(X\)</span> (including a constant) with an error <span class="math inline">\(u\)</span>, which is by definition heteroskedastic. In this case, the location model coefficients are identified under the following condition: <span id="eq-eq7"><span class="math display">\[\begin{aligned}
  y_i &amp;=x_i'\beta+u_i \\
  E[u 'X ] &amp;=0
  \end{aligned}
\tag{7}\]</span></span></p></li>
<li><p>After the location model is estimated, the scale coefficients can be identified by modeling heteroskedasticity as a linear function of characteristics <span class="math inline">\(X\)</span>. For this we use the absolute value of the errors from the location model <span class="math inline">\(u\)</span> as dependent variable, which would allow us to estimate the conditional standard deviation (rather than conditional variance) of the errors. In this case, the coefficients are identified under the following condition:</p></li>
</ol>
<p><span id="eq-eq8"><span class="math display">\[\begin{aligned}
  |u_i| &amp;=x_i'\gamma+v_i \\
  E[ (|u|-X \gamma) X ] &amp;=0
  \end{aligned}
\tag{8}\]</span></span></p>
<ol start="3" type="1">
<li>Finally, given the location and scale coefficients, the <span class="math inline">\(\tau_{th}\)</span> quantile of the error <span class="math inline">\(e\)</span> can be estimated using the following condition:</li>
</ol>
<p><span id="eq-eq8"><span class="math display">\[\begin{aligned}
  E\left[  \mathbb{1}\left(x_i' (\beta + \gamma Q(\varepsilon|\tau)) \geq y_i \right) - \tau \right] &amp;=0  \\
  E\left[  \mathbb{1}\left(   Q(\varepsilon|\tau)\geq \frac{y_i-x_i'\beta}{x_i'\gamma} \right) - \tau \right] &amp;=0  \\
  \end{aligned}
\tag{9}\]</span></span></p>
<p>Where one identifies the quantile of the error <span class="math inline">\(\varepsilon\)</span> using standardized errors , or by finding the values that identify the overall quantile coefficients <span class="math inline">\(\beta(\tau)=\beta + \gamma Q(\varepsilon|\tau)\)</span>.</p>
</section>
<section id="standard-errors-gls-robust-clustered" class="level2">
<h2 class="anchored" data-anchor-id="standard-errors-gls-robust-clustered">Standard Errors: GLS, Robust, Clustered</h2>
</section>
<section id="multiple-fixed-effects-expanding-on-mss2019" class="level2">
<h2 class="anchored" data-anchor-id="multiple-fixed-effects-expanding-on-mss2019">Multiple Fixed Effects: Expanding on <span class="citation" data-cites="mss2019">Machado and Santos Silva (<a href="#ref-mss2019" role="doc-biblioref">2019</a>)</span></h2>
</section>
</section>
<section id="monte-carlo-simulations" class="level1">
<h1>Monte Carlo Simulations</h1>
</section>
<section id="application-something-interesting" class="level1">
<h1>Application: <strong>Something interesting</strong></h1>
</section>
<section id="conclusions" class="level1">
<h1>Conclusions</h1>
</section>

<section id="references" class="level1 unnumbered">


</section>


<div id="quarto-appendix" class="default"><section id="appendix" class="level1 appendix"><h2 class="anchored quarto-appendix-heading">Appendix</h2><div class="quarto-appendix-contents">

</div></section><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-cameron2005" class="csl-entry" role="listitem">
Cameron, Adrian Colin, and Pravin K. Trivedi. 2005. <em>Microeconometrics: Methods and Applications</em>. Cambridge ; New York: Cambridge University Press.
</div>
<div id="ref-canay2011" class="csl-entry" role="listitem">
Canay, Ivan A. 2011. <span>“A Simple Approach to Quantile Regression for Panel Data.”</span> <em>The Econometrics Journal</em> 14 (3): 368–86. https://doi.org/<a href="https://doi.org/10.1111/j.1368-423X.2011.00349.x">https://doi.org/10.1111/j.1368-423X.2011.00349.x</a>.
</div>
<div id="ref-frishwaugh1933" class="csl-entry" role="listitem">
Frisch, Ragnar, and Frederick V. Waugh. 1933. <span>“Partial Time Regressions as Compared with Individual Trends.”</span> <em>Econometrica</em> 1 (4): 387–401. <a href="http://www.jstor.org/stable/1907330">http://www.jstor.org/stable/1907330</a>.
</div>
<div id="ref-frumentobotai2016" class="csl-entry" role="listitem">
Frumento, Paolo, and Matteo Bottai. 2016. <span>“Parametric Modeling of Quantile Regression Coefficient Functions.”</span> <em>Biometrics</em> 72 (1): 74–84. https://doi.org/<a href="https://doi.org/10.1111/biom.12410">https://doi.org/10.1111/biom.12410</a>.
</div>
<div id="ref-he1997" class="csl-entry" role="listitem">
He, Xuming. 1997. <span>“Quantile Curves Without Crossing.”</span> <em>The American Statistician</em> 51 (2): 186–92. <a href="https://doi.org/10.1080/00031305.1997.10473959">https://doi.org/10.1080/00031305.1997.10473959</a>.
</div>
<div id="ref-kaplan2017" class="csl-entry" role="listitem">
Kaplan, David M., and Yixiao Sun. 2017. <span>“Smoothed Estimating Equations for Instrumental Variables Quantile Regression.”</span> <em>Econometric Theory</em> 33 (1): 105–57. <a href="https://doi.org/10.1017/S0266466615000407">https://doi.org/10.1017/S0266466615000407</a>.
</div>
<div id="ref-koenker2004" class="csl-entry" role="listitem">
Koenker, Roger. 2004. <span>“Quantile Regression for Longitudinal Data.”</span> <em>Journal of Multivariate Analysis</em> 91 (1): 74–89. https://doi.org/<a href="https://doi.org/10.1016/j.jmva.2004.05.006">https://doi.org/10.1016/j.jmva.2004.05.006</a>.
</div>
<div id="ref-koenkerbasset1978" class="csl-entry" role="listitem">
Koenker, Roger, and Gilbert Bassett. 1978. <span>“Regression Quantiles.”</span> <em>Econometrica</em> 46 (1): 33–50. <a href="http://www.jstor.org/stable/1913643">http://www.jstor.org/stable/1913643</a>.
</div>
<div id="ref-lancaster2000" class="csl-entry" role="listitem">
Lancaster, Tony. 2000. <span>“The Incidental Parameter Problem Since 1948.”</span> <em>Journal of Econometrics</em> 95 (2): 391–413. https://doi.org/<a href="https://doi.org/10.1016/S0304-4076(99)00044-5">https://doi.org/10.1016/S0304-4076(99)00044-5</a>.
</div>
<div id="ref-lovell1963" class="csl-entry" role="listitem">
Lovell, Michael C. 1963. <span>“Seasonal Adjustment of Economic Time Series and Multiple Regression Analysis.”</span> <em>Journal of the American Statistical Association</em> 58 (304): 993–1010. <a href="https://doi.org/10.1080/01621459.1963.10480682">https://doi.org/10.1080/01621459.1963.10480682</a>.
</div>
<div id="ref-mss2019" class="csl-entry" role="listitem">
Machado, José A. F., and J. M. C. Santos Silva. 2019. <span>“Quantiles via Moments.”</span> <em>Journal of Econometrics</em> 213 (1): 145–73. <a href="https://doi.org/10.1016/j.jeconom.2019.04.009">https://doi.org/10.1016/j.jeconom.2019.04.009</a>.
</div>
<div id="ref-melly2005" class="csl-entry" role="listitem">
Melly, Blaise. 2005. <span>“Decomposition of Differences in Distribution Using Quantile Regression.”</span> <em>Labour Economics</em> 12 (4): 577–90. https://doi.org/<a href="https://doi.org/10.1016/j.labeco.2005.05.006">https://doi.org/10.1016/j.labeco.2005.05.006</a>.
</div>
<div id="ref-neymanscott1948" class="csl-entry" role="listitem">
Neyman, J., and Elizabeth L. Scott. 1948. <span>“Consistent Estimates Based on Partially Consistent Observations.”</span> <em>Econometrica</em> 16 (1): 1–32. <a href="http://www.jstor.org/stable/1914288">http://www.jstor.org/stable/1914288</a>.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>There are other estimators that provide smoother estimates for the quantile regression coefficients using a kernel local weighted approach <span class="citation" data-cites="kaplan2017">(<a href="#ref-kaplan2017" role="doc-biblioref">Kaplan and Sun 2017</a>)</span>, as well as identifying the full set of quantile coefficients simultaneously assuming some parametric functional forms <span class="citation" data-cites="frumentobotai2016">(<a href="#ref-frumentobotai2016" role="doc-biblioref">Frumento and Bottai 2016</a>)</span>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p><span class="citation" data-cites="mss">(<a href="#ref-mss" role="doc-biblioref"><strong>mss?</strong></a>)</span> also discuss a model where heteroskedasticity can be an arbitrary nonlinear function <span class="math inline">\(\sigma(x_i'\gamma)\)</span>, but develop the estimator for the linear case, i.e., when <span class="math inline">\(\sigma()\)</span> is the identity function.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>